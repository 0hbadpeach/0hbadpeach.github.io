<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>루미아 섬 시뮬레이터</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

  <!-- 로딩 오버레이 -->
  <div id="loadingOverlay" class="loading-overlay">
    <div class="loading-center">
      <div class="loading-mark">
        <div class="mark-line"></div>
        <div class="mark-circle">Λ</div>
        <div class="mark-line"></div>
      </div>
      <div id="loadingText" class="loading-text">Loading... (0%)</div>
      <div class="loading-bar">
        <div id="loadingBarFill" class="loading-bar-fill"></div>
      </div>
    </div>
  </div>

  <header class="topbar">
    <div class="title">
      <div class="h1">루미아 섬 시뮬레이터</div>
      <div class="sub">일반 대전 · 24명 / 8팀</div>
    </div>
    <div class="top-actions">
      <button id="btnResetAll" class="btn mini danger">초기화</button>
    </div>
  </header>

  <main class="layout">
    <section class="grid3">
      <!-- 실험체 풀 -->
      <div class="panel">
        <div class="panel-head">
          <div class="panel-title">실험체 풀</div>
          <div class="panel-head-right">
            <button class="btn mini" id="btnTogglePool">접기</button>
          </div>
        </div>

        <div id="poolBody" class="panel-body">
          <div class="row gap">
            <input id="poolSearch" class="input" placeholder="이름 검색 (예: 아야 / 14M-RFT11)" />
            <button id="btnClearSearch" class="btn mini">지우기</button>
          </div>

          <div class="row gap mt8">
            <button id="btnOCOpen" class="btn mini">오리지널 실험체 생성</button>
            <button id="btnOCClear" class="btn mini danger">오리지널 초기화</button>
          </div>

          <div class="hint mt8">
            • 실험체 클릭 = “선택”<br/>
            • 팀 슬롯 클릭 = 선택 실험체 배치 (중복 가능)<br/>
            • 슬롯은 드래그로 팀↔팀 이동 가능 (드래그가 글자만 잡히면 CSS의 user-select/drag 설정 확인)
          </div>

          <div id="poolList" class="list mt8"></div>
        </div>
      </div>

      <!-- 팀 편성 -->
      <div class="panel">
        <div class="panel-head">
          <div class="panel-title">팀 편성 (Team 1~8, 총 24명)</div>
          <div class="panel-head-right">
            <button class="btn mini" id="btnToggleTeams">접기</button>
          </div>
        </div>

        <div id="teamsBody" class="panel-body">
          <div class="row gap">
            <button id="btnFillEmptyRandom" class="btn mini">빈 칸 랜덤 배치</button>
            <button id="btnFillAllRandom" class="btn mini">전체 랜덤 배치</button>
            <button id="btnClearTeams" class="btn mini danger">팀 비우기</button>
            <div class="spacer"></div>
            <button id="btnStartSim" class="btn">시뮬레이션 시작</button>
          </div>

          <div id="teamsGrid" class="teams-grid mt8"></div>
        </div>
      </div>

      <!-- 지도(박스형) -->
      <div class="panel">
        <div class="panel-head">
          <div class="panel-title">루미아 섬 지도 (박스형)</div>
          <div class="panel-head-right">
            <button class="btn mini" id="btnToggleMap">접기</button>
          </div>
        </div>

        <div id="mapBody" class="panel-body">
          <div class="row gap">
            <span class="badge normal">정상</span>
            <span class="badge warn">금지예정</span>
            <span class="badge danger">금지구역</span>
            <div class="spacer"></div>
            <button id="btnAdvanceBan" class="btn mini">금지 단계 진행</button>
          </div>

          <div class="hint mt8">지역에 마우스를 올리면 해당 지역의 팀/인원이 표시됩니다.</div>
          <div id="mapGrid" class="map-grid mt8"></div>

          <div id="mapInfo" class="map-info mt8">
            <div class="map-info-title">지역 정보</div>
            <div id="mapInfoBody" class="map-info-body">지역에 마우스를 올려주세요.</div>
          </div>
        </div>
      </div>
    </section>

    <!-- 로그 패널 -->
    <section class="panel log-panel">
      <div class="panel-head">
        <div class="panel-title">진행 로그</div>
        <div class="panel-head-right">
          <button id="btnNextTurn" class="btn mini">다음 턴</button>
          <button id="btnAutoStart" class="btn mini">자동 시작</button>
          <button id="btnAutoStop" class="btn mini danger">자동 중지</button>
          <button id="btnOpenResults" class="btn mini">결과</button>
          <button id="btnClearLog" class="btn mini">로그 지우기</button>
        </div>
      </div>
      <div class="panel-body">
        <div id="logBox" class="logbox"></div>
      </div>
    </section>
  </main>

  <!-- 오리지널 생성 모달 -->
  <div id="ocModal" class="modal">
    <div class="modal-card">
      <div class="modal-head">
        <div class="modal-title">오리지널 실험체 생성</div>
        <button id="ocModalX" class="btn mini danger">X</button>
      </div>

      <div class="modal-body">
        <div class="row gap">
          <input id="ocCodename" class="input" placeholder="코드네임 (예: 14M-RFT11)" />
          <input id="ocName" class="input" placeholder="이름" />
        </div>

        <div class="mt8">
          <div class="hint">역할군 (복수 선택 가능)</div>
          <div id="ocRoleChips" class="chips mt8"></div>
        </div>

        <div class="mt8">
          <div class="hint">무기 선택</div>
          <select id="ocWeapon" class="input mt8"></select>
        </div>

        <div class="row gap mt12">
          <button id="btnAddOC" class="btn">추가</button>
          <button id="btnSaveOC" class="btn mini">저장(로컬)</button>
          <button id="btnLoadOC" class="btn mini">불러오기(로컬)</button>
          <button id="ocModalClose" class="btn mini danger">닫기</button>
        </div>

        <div class="hint mt8">※ 저장/불러오기는 브라우저 localStorage 기반</div>
      </div>
    </div>
  </div>

  <!-- 결과 모달 -->
  <div id="resultModal" class="modal">
    <div class="modal-card wide">
      <div class="modal-head">
        <div class="modal-title">결과</div>
        <button id="resultModalX" class="btn mini danger">X</button>
      </div>
      <div class="modal-body">
        <div id="resultBody" class="result-body"></div>
        <div class="row gap mt12">
          <button id="resultModalClose" class="btn mini danger">닫기</button>
        </div>
      </div>
    </div>
  </div>

  <!-- 스크립트 순서 중요 -->
  <script src="js/data.js"></script>
  <script src="js/ui.js"></script>
  <script src="js/storage.js"></script>
  <script src="js/map.js"></script>
  <script src="js/lobby.js"></script>
  <script src="js/sim.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
